<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rock::CLI::ReleaseAdmin
  
    &mdash; TestScripts Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Rock::CLI::ReleaseAdmin";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Rock.html" title="Rock (module)">Rock</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../CLI.html" title="Rock::CLI (module)">CLI</a></span></span>
     &raquo; 
    <span class="title">ReleaseAdmin</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rock::CLI::ReleaseAdmin
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Thor</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Thor</li>
          
            <li class="next">Rock::CLI::ReleaseAdmin</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rock/cli/release_admin.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Implementation of the rock-release admin subcommand</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="ReleaseAdmin/Maintainers.html" title="Rock::CLI::ReleaseAdmin::Maintainers (class)">Maintainers</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="ROCK_VCS_LOCATIONS-constant" class="">ROCK_VCS_LOCATIONS =
          
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
<span class='comment'>#/gitorious.*\/rock(?:-[\w-]+)?\//,
</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>github.*\/rock(?:-[\w-]+)?\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
<span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>github.*\/orocos-toolchain\/</span><span class='regexp_end'>/</span></span><span class='rbracket'>]</span></pre></dd>
      
        <dt id="DEFAULT_MAILMAP-constant" class="">DEFAULT_MAILMAP =
          
        </dt>
        <dd><pre class="code"><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>release_mailmap.yml</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="RC_ANNOUNCEMENT_FROM-constant" class="">RC_ANNOUNCEMENT_FROM =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Rock Developers &lt;rock-dev@dfki.de&gt;</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="RC_ANNOUNCEMENT_TEMPLATE_PATH-constant" class="">RC_ANNOUNCEMENT_TEMPLATE_PATH =
          
        </dt>
        <dd><pre class="code"><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span>
<span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>templates</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rock-release-announce-rc.email.template</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
<span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='rparen'>)</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#authors_of-instance_method" title="#authors_of (instance method)">#<strong>authors_of</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List of package names for which this group of people are declared as
authors, and for which no maintainer is explicitely declared.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#emails-instance_method" title="#emails (instance method)">#<strong>emails</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The list of maintainers emails, formatted as “Name &amp;lt;email&amp;gt;”.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#external_master_packages-instance_method" title="#external_master_packages (instance method)">#<strong>external_master_packages</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The name of the master-only packages maintained by this group of people,
that are NOT managed within the Rock infrastructure.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#external_stable_packages-instance_method" title="#external_stable_packages (instance method)">#<strong>external_stable_packages</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The name of the packages present in stable, maintained by this group of
people, that are NOT managed within the Rock infrastructure.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#maintainers_of-instance_method" title="#maintainers_of (instance method)">#<strong>maintainers_of</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List of package names for which this group of people are explicitely
declared as maintainers.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#rock_master_packages-instance_method" title="#rock_master_packages (instance method)">#<strong>rock_master_packages</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The name of the master-only packages maintained by this group of people,
that are managed within the Rock infrastructure.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#rock_stable_packages-instance_method" title="#rock_stable_packages (instance method)">#<strong>rock_stable_packages</strong>  &#x21d2; [String] </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The name of the packages present in stable, maintained by this group of
people, that are managed within the Rock infrastructure.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exit_on_failure%3F-class_method" title="exit_on_failure? (class method)">.<strong>exit_on_failure?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#announce_rc-instance_method" title="#announce_rc (instance method)">#<strong>announce_rc</strong>(rock_release_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#checkout-instance_method" title="#checkout (instance method)">#<strong>checkout</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_pull_requests-instance_method" title="#create_pull_requests (instance method)">#<strong>create_pull_requests</strong>(source, target)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_rc-instance_method" title="#create_rc (instance method)">#<strong>create_rc</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_labels-instance_method" title="#delete_labels (instance method)">#<strong>delete_labels</strong>(label)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_rc-instance_method" title="#delete_rc (instance method)">#<strong>delete_rc</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#maintainer_info-instance_method" title="#maintainer_info (instance method)">#<strong>maintainer_info</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#notes-instance_method" title="#notes (instance method)">#<strong>notes</strong>(release_name, last_release_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepare-instance_method" title="#prepare (instance method)">#<strong>prepare</strong>(release_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#push_labels-instance_method" title="#push_labels (instance method)">#<strong>push_labels</strong>(label)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#push_to_stable-instance_method" title="#push_to_stable (instance method)">#<strong>push_to_stable</strong>(branch)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_rc-instance_method" title="#update_rc (instance method)">#<strong>update_rc</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="authors_of=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="authors_of-instance_method">
  
    #<strong>authors_of</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>List of package names for which this group of people are declared as
authors, and for which no maintainer is explicitely declared</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="emails=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="emails-instance_method">
  
    #<strong>emails</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The list of maintainers emails, formatted as “Name &amp;lt;email&amp;gt;”</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="external_master_packages=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="external_master_packages-instance_method">
  
    #<strong>external_master_packages</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The name of the master-only packages maintained by this group of people,
that are NOT managed within the Rock infrastructure</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="external_stable_packages=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="external_stable_packages-instance_method">
  
    #<strong>external_stable_packages</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The name of the packages present in stable, maintained by this group of
people, that are NOT managed within the Rock infrastructure</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="maintainers_of=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="maintainers_of-instance_method">
  
    #<strong>maintainers_of</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>List of package names for which this group of people are explicitely
declared as maintainers</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="rock_master_packages=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="rock_master_packages-instance_method">
  
    #<strong>rock_master_packages</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The name of the master-only packages maintained by this group of people,
that are managed within the Rock infrastructure</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="rock_stable_packages=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="rock_stable_packages-instance_method">
  
    #<strong>rock_stable_packages</strong>  &#x21d2; <tt>[String]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The name of the packages present in stable, maintained by this group of
people, that are managed within the Rock infrastructure</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[String]</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 365</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="exit_on_failure?-class_method">
  
    .<strong>exit_on_failure?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 13</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_exit_on_failure?'>exit_on_failure?</span><span class='semicolon'>;</span> <span class='kw'>true</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="announce_rc-instance_method">
  
    #<strong>announce_rc</strong>(rock_release_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 472</span>

<span class='kw'>def</span> <span class='id identifier rubyid_announce_rc'>announce_rc</span><span class='lparen'>(</span><span class='id identifier rubyid_rock_release_name'>rock_release_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='const'>ERB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#RC_ANNOUNCEMENT_TEMPLATE_PATH-constant" title="Rock::CLI::ReleaseAdmin::RC_ANNOUNCEMENT_TEMPLATE_PATH (constant)">RC_ANNOUNCEMENT_TEMPLATE_PATH</a></span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;&gt;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_all_maintainers'>all_maintainers</span><span class='comma'>,</span> <span class='id identifier rubyid_warnings'>warnings</span> <span class='op'>=</span> <span class='id identifier rubyid_compute_maintainers'>compute_maintainers</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='comment'># Only look at packages in rock. rock.core, rock.tutorials
</span>        <span class='comment'># and orocos.toolchain are handled differently
</span>        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_package_set'>package_set</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rock</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_warnings'>warnings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg_name'>pkg_name</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_manifest'>manifest</span><span class='period'>.</span><span class='id identifier rubyid_find_package'>find_package</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_name'>pkg_name</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
            <span class='const'><span class='object_link'><a href="" title="Rock::CLI::ReleaseAdmin (class)">ReleaseAdmin</a></span></span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line'>line</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_package_count'>package_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_emails'>emails</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_all_maintainers'>all_maintainers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span>
        <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_maintainers_of'>maintainers_of</span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_authors_of'>authors_of</span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_guessed_authors_of'>guessed_authors_of</span>
        <span class='id identifier rubyid_package_count'>package_count</span> <span class='op'>+=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
        <span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Let&#39;s prepare Rock </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rock_release_name'>rock_release_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_subject_packages'>subject_packages</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_remaining'>remaining</span> <span class='op'>=</span> <span class='int'>80</span> <span class='op'>-</span> <span class='id identifier rubyid_subject'>subject</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>10</span>
        <span class='kw'>while</span> <span class='op'>!</span><span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_remaining'>remaining</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_subject_packages'>subject_packages</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
            <span class='id identifier rubyid_remaining'>remaining</span> <span class='op'>-=</span> <span class='id identifier rubyid_subject_packages'>subject_packages</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>2</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subject'>subject</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subject_packages'>subject_packages</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
            <span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subject'>subject</span><span class='embexpr_end'>}</span><span class='tstring_content'> and </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> others)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subject'>subject</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_emails'>emails</span> <span class='op'>&lt;&lt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span>
            <span class='label'>from:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span><span class='comma'>,</span>
            <span class='label'>to:</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_emails'>emails</span><span class='comma'>,</span>
            <span class='label'>subject:</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span>
            <span class='label'>body:</span> <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UTF-8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>undef:</span> <span class='symbol'>:replace</span><span class='rparen'>)</span>
        <span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_emails'>emails</span> <span class='op'>=</span> <span class='id identifier rubyid_emails'>emails</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_emails'>emails</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_forced_to'>forced_to</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:to</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:sendgrid_user</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:sendgrid_key</span><span class='rbracket'>]</span>
        <span class='const'><span class='object_link'><a href="" title="Rock::CLI::ReleaseAdmin (class)">ReleaseAdmin</a></span></span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No sendgrid user and key given, saving the emails on disk</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_emails'>emails</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
            <span class='const'><span class='object_link'><a href="" title="Rock::CLI::ReleaseAdmin (class)">ReleaseAdmin</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>writing </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>.txt</span><span class='tstring_end'>&quot;</span></span>
            <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>.txt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>From: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>To: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_forced_to'>forced_to</span> <span class='op'>||</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:to</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subject: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:subject</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span>
            <span class='kw'>end</span>
        <span class='kw'>end</span>
    <span class='kw'>else</span>
        <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sendgrid-ruby</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'>SendGrid</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>api_user:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:sendgrid_user</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>api_key:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:sendgrid_key</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_emails'>emails</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span>
            <span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='const'>SendGrid</span><span class='op'>::</span><span class='const'>Mail</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_em'>em</span><span class='op'>|</span>
                <span class='id identifier rubyid_em'>em</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span>
                <span class='id identifier rubyid_em'>em</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_forced_to'>forced_to</span> <span class='op'>||</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:to</span><span class='rbracket'>]</span><span class='rparen'>)</span>
                <span class='id identifier rubyid_em'>em</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:subject</span><span class='rbracket'>]</span>
                <span class='id identifier rubyid_em'>em</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span>
            <span class='kw'>end</span>
            <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_email'>email</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='const'><span class='object_link'><a href="" title="Rock::CLI::ReleaseAdmin (class)">ReleaseAdmin</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>notified maintainers of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_package_count'>package_count</span><span class='embexpr_end'>}</span><span class='tstring_content'> packages in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_emails'>emails</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> emails</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="checkout-instance_method">
  
    #<strong>checkout</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


794
795
796
797
798
799</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 794</span>

<span class='kw'>def</span> <span class='id identifier rubyid_checkout'>checkout</span>
    <span class='const'>Autobuild</span><span class='period'>.</span><span class='id identifier rubyid_do_update'>do_update</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:flavor</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='label'>checkout_only:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>only_local:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_pull_requests-instance_method">
  
    #<strong>create_pull_requests</strong>(source, target)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 924</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_pull_requests'>create_pull_requests</span><span class='lparen'>(</span><span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You must specify a branch</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_exit'>exit</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>master</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrong use</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_exit'>exit</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_local'>local</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:local</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='label'>checkout_only:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='id identifier rubyid_importer'>importer</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No importer for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='symbol'>:only_local</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='comment'>#Can be done locally because update was done before
</span>        <span class='id identifier rubyid_needs_merge'>needs_merge</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-a</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--contains</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_needs_merge'>needs_merge</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Package </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> needs a merge creating pull-request</span><span class='tstring_end'>&quot;</span></span>
            <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_srcdir'>srcdir</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_dir'>dir</span><span class='op'>|</span>
                <span class='id identifier rubyid_call'>call</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hub pull-request -f -m &#39;Automatic rock-release PR: integrate rc-patches in master&#39; -b </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'> -h </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
                <span class='id identifier rubyid_erg'>erg</span> <span class='op'>=</span> <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='id identifier rubyid_call'>call</span><span class='rparen'>)</span>
                <span class='kw'>if</span><span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_erg'>erg</span><span class='rparen'>)</span>
                    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not run hub pull request for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>, result is </span><span class='embexpr_beg'>#{</span><span class='gvar'>$?</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
                <span class='kw'>end</span>
            <span class='kw'>end</span>
        <span class='kw'>end</span>

    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_rc-instance_method">
  
    #<strong>create_rc</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 551</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_rc'>create_rc</span>
    <span class='comment'># We checkout and branch all packages, not only the stable
</span>    <span class='comment'># ones, to ease release of new packages. This does not mean
</span>    <span class='comment'># that we&#39;re going to release all of them, of course !
</span>    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_check_out_missing_packages'>check_out_missing_packages</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_branch'>branch</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:branch</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Creating the package sets RC branch</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_package_sets'>package_sets</span> <span class='op'>=</span> <span class='id identifier rubyid_manifest'>manifest</span><span class='period'>.</span><span class='id identifier rubyid_each_remote_package_set'>each_remote_package_set</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
    <span class='id identifier rubyid_package_sets'>package_sets</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_package_sets'>package_sets</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_repository_id'>repository_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_create_autobuild_package'>create_autobuild_package</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:update</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_has_commit?'>has_commit?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refs/remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>remote</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>push</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>autobuild</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+refs/remotes/autobuild/master:refs/heads/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_versions'>versions</span> <span class='op'>&lt;&lt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pkg_set:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_repository_id'>repository_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_branch'>branch</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Creating the packages RC branch</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:update</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_has_commit?'>has_commit?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refs/remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>remote</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_reference_branch'>reference_branch</span> <span class='op'>=</span>
                <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../Rock.html" title="Rock (module)">Rock</a></span></span><span class='period'>.</span><span class='id identifier rubyid_flavors'>flavors</span><span class='period'>.</span><span class='id identifier rubyid_package_in_flavor?'>package_in_flavor?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stable</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
                    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stable</span><span class='tstring_end'>&#39;</span></span>
                <span class='kw'>else</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span>
                <span class='kw'>end</span>
            <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>push</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>autobuild</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+refs/remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_reference_branch'>reference_branch</span><span class='embexpr_end'>}</span><span class='tstring_content'>:refs/heads/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_versions'>versions</span> <span class='op'>&lt;&lt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=&gt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_branch'>branch</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='comment'>#Finally update the release description file
</span>    <span class='id identifier rubyid_update_rc'>update_rc</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_labels-instance_method">
  
    #<strong>delete_labels</strong>(label)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 884</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_labels'>delete_labels</span><span class='lparen'>(</span><span class='id identifier rubyid_label'>label</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_label'>label</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You must specify a label</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_local'>local</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:local</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='label'>checkout_only:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='id identifier rubyid_importer'>importer</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No importer for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
        <span class='kw'>end</span>
        <span class='kw'>begin</span>
            <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tag</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-d</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_label'>label</span><span class='rparen'>)</span>
        <span class='kw'>rescue</span> <span class='const'>Autobuild</span><span class='op'>::</span><span class='const'>SubcommandFailed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
            <span class='comment'>#TODO should not catched this way
</span>        <span class='kw'>end</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_rc-instance_method">
  
    #<strong>delete_rc</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 681</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_rc'>delete_rc</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_branch'>branch</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_check_out_missing_packages'>check_out_missing_packages</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stable</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='label'>checkout_only:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='id identifier rubyid_importer'>importer</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No importer for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='comment'>#return -1
</span>        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_has_commit?'>has_commit?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refs/remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>push</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>autobuild</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>else</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> has no rc-branch</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="maintainer_info-instance_method">
  
    #<strong>maintainer_info</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 411</span>

<span class='kw'>def</span> <span class='id identifier rubyid_maintainer_info'>maintainer_info</span>
    <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csv</span><span class='tstring_end'>&#39;</span></span>

    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:mailmap</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_mailmap'>mailmap</span> <span class='op'>=</span> <span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:mailmap</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='id identifier rubyid_mailmap'>mailmap</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_packages'>packages</span>  <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>+=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stable</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg_def'>pkg_def</span><span class='op'>|</span>
        <span class='id identifier rubyid_manifest_xml'>manifest_xml</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg_def'>pkg_def</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_def'>pkg_def</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_maintainers'>maintainers</span> <span class='op'>=</span> <span class='id identifier rubyid_make_emails'>make_emails</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_xml'>manifest_xml</span><span class='period'>.</span><span class='id identifier rubyid_each_rock_maintainer'>each_rock_maintainer</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span> <span class='op'>+</span> <span class='id identifier rubyid_manifest_xml'>manifest_xml</span><span class='period'>.</span><span class='id identifier rubyid_each_maintainer'>each_maintainer</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='comma'>,</span> <span class='id identifier rubyid_mailmap'>mailmap</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_maintainers'>maintainers</span> <span class='op'>=</span> <span class='id identifier rubyid_maintainers'>maintainers</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_maintainers'>maintainers</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>W: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
            <span class='id identifier rubyid_authors'>authors</span>     <span class='op'>=</span> <span class='id identifier rubyid_make_emails'>make_emails</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_xml'>manifest_xml</span><span class='period'>.</span><span class='id identifier rubyid_each_author'>each_author</span><span class='comma'>,</span> <span class='id identifier rubyid_mailmap'>mailmap</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_authors'>authors</span>     <span class='op'>=</span> <span class='id identifier rubyid_authors'>authors</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_authors'>authors</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>W: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
            <span class='id identifier rubyid_git_authors'>git_authors</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_maintainers'>maintainers</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_authors'>authors</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
                <span class='id identifier rubyid_git_authors'>git_authors</span> <span class='op'>=</span> <span class='id identifier rubyid_guess_authors_from_git'>guess_authors_from_git</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_def'>pkg_def</span><span class='comma'>,</span> <span class='label'>mailmap:</span> <span class='id identifier rubyid_mailmap'>mailmap</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
            <span class='kw'>end</span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_maintainers'>maintainers</span> <span class='op'>=</span> <span class='id identifier rubyid_make_emails'>make_emails</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_xml'>manifest_xml</span><span class='period'>.</span><span class='id identifier rubyid_each_rock_maintainer'>each_rock_maintainer</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='comma'>,</span> <span class='id identifier rubyid_mailmap'>mailmap</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_maintainers'>maintainers</span> <span class='op'>=</span> <span class='id identifier rubyid_maintainers'>maintainers</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_maintainers'>maintainers</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>W: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
            <span class='id identifier rubyid_authors'>authors</span><span class='comma'>,</span> <span class='id identifier rubyid_git_authors'>git_authors</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_pkg_def'>pkg_def</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_maintainers'>maintainers</span><span class='comma'>,</span> <span class='id identifier rubyid_authors'>authors</span><span class='comma'>,</span> <span class='id identifier rubyid_git_authors'>git_authors</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_line_count'>line_count</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
        <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arr'>arr</span><span class='op'>|</span>
            <span class='id identifier rubyid_arr'>arr</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>*</span> <span class='lparen'>(</span><span class='id identifier rubyid_line_count'>line_count</span> <span class='op'>-</span> <span class='id identifier rubyid_arr'>arr</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:csv</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
            <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_to_csv'>to_csv</span>
        <span class='kw'>end</span>
    <span class='kw'>else</span>
        <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
            <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="notes-instance_method">
  
    #<strong>notes</strong>(release_name, last_release_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 802</span>

<span class='kw'>def</span> <span class='id identifier rubyid_notes'>notes</span><span class='lparen'>(</span><span class='id identifier rubyid_release_name'>release_name</span><span class='comma'>,</span> <span class='id identifier rubyid_last_release_name'>last_release_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>master</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_ops'>ops</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_last_versions_file'>last_versions_file</span> <span class='op'>=</span> <span class='id identifier rubyid_ops'>ops</span><span class='period'>.</span><span class='id identifier rubyid_fetch_version_file'>fetch_version_file</span><span class='lparen'>(</span><span class='id identifier rubyid_last_release_name'>last_release_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_last_versions'>last_versions</span> <span class='op'>=</span> <span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_last_versions_file'>last_versions_file</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_last_packages_names'>last_packages_names</span> <span class='op'>=</span> <span class='id identifier rubyid_last_versions'>last_versions</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_vcs'>vcs</span><span class='op'>|</span> <span class='id identifier rubyid_vcs'>vcs</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='rbrace'>}</span><span class='period'>.</span>
        <span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>!~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^pkg_set:</span><span class='regexp_end'>/</span></span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_packages_names'>packages_names</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_new_packages'>new_packages</span>     <span class='op'>=</span> <span class='id identifier rubyid_packages_names'>packages_names</span> <span class='op'>-</span> <span class='id identifier rubyid_last_packages_names'>last_packages_names</span>
    <span class='id identifier rubyid_obsolete_packages'>obsolete_packages</span> <span class='op'>=</span> <span class='id identifier rubyid_last_packages_names'>last_packages_names</span> <span class='op'>-</span> <span class='id identifier rubyid_packages_names'>packages_names</span>

    <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg_name'>pkg_name</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_new_packages'>new_packages</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_name'>pkg_name</span><span class='rparen'>)</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_obsolete_packages'>obsolete_packages</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_name'>pkg_name</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_changes'>changes</span> <span class='op'>=</span> <span class='id identifier rubyid_package_changelog'>package_changelog</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='comma'>,</span> <span class='id identifier rubyid_release_name'>release_name</span><span class='comma'>,</span> <span class='id identifier rubyid_last_release_name'>last_release_name</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_changes'>changes</span>
            <span class='id identifier rubyid_status'>status</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_changes'>changes</span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_errors'>errors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pkg_name'>pkg_name</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>


    <span class='id identifier rubyid_template'>template</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>templates</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rock-release-notes.md.template</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_erb'>erb</span> <span class='op'>=</span> <span class='const'>ERB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_template'>template</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_sort_info'>sort_info</span> <span class='op'>=</span> <span class='id identifier rubyid_release_name'>release_name</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Creating Relase notes: </span><span class='embexpr_beg'>#{</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_config_dir'>config_dir</span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#RELEASE_NOTES-constant" title="Rock::CLI::Release::RELEASE_NOTES (constant)">RELEASE_NOTES</a></span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_config_dir'>config_dir</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#RELEASE_NOTES-constant" title="Rock::CLI::Release::RELEASE_NOTES (constant)">RELEASE_NOTES</a></span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
        <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_erb'>erb</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span><span class='lparen'>(</span><span class='id identifier rubyid_binding'>binding</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepare-instance_method">
  
    #<strong>prepare</strong>(release_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 976</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare'>prepare</span><span class='lparen'>(</span><span class='id identifier rubyid_release_name'>release_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>master</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Checking out missing packages</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='label'>checkout_only:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tagging package sets</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_failed_package_sets'>failed_package_sets</span> <span class='op'>=</span> <span class='id identifier rubyid_tag_rock_packages'>tag_rock_packages</span><span class='lparen'>(</span>
        <span class='id identifier rubyid_manifest'>manifest</span><span class='period'>.</span><span class='id identifier rubyid_each_remote_package_set'>each_remote_package_set</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:create_autobuild_package</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='id identifier rubyid_release_name'>release_name</span><span class='comma'>,</span>
        <span class='label'>branch:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:branch</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_failed_package_sets'>failed_package_sets</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>failed to prepare </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_failed_package_sets'>failed_package_sets</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> package sets</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tagging all Rock-managed packages</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_tag'>packages_to_tag</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_failed_packages'>failed_packages</span> <span class='op'>=</span> <span class='id identifier rubyid_tag_rock_packages'>tag_rock_packages</span><span class='lparen'>(</span>
        <span class='id identifier rubyid_packages_to_tag'>packages_to_tag</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:autobuild</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='id identifier rubyid_release_name'>release_name</span><span class='comma'>,</span>
        <span class='label'>branch:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:branch</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_failed_packages'>failed_packages</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>failed to prepare </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_failed_packages'>failed_packages</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> packages</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_version_path'>version_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_config_dir'>config_dir</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#RELEASE_VERSIONS-constant" title="Rock::CLI::Release::RELEASE_VERSIONS (constant)">RELEASE_VERSIONS</a></span></span><span class='rparen'>)</span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Creating version file, and saving it in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_version_path'>version_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_ops'>ops</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>Ops</span><span class='op'>::</span><span class='const'>Snapshot</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='label'>keep_going:</span> <span class='kw'>false</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='id identifier rubyid_ops'>ops</span><span class='period'>.</span><span class='id identifier rubyid_snapshot_package_sets'>snapshot_package_sets</span> <span class='op'>+</span>
        <span class='id identifier rubyid_ops'>ops</span><span class='period'>.</span><span class='id identifier rubyid_snapshot_packages'>snapshot_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='id identifier rubyid_ops'>ops</span><span class='period'>.</span><span class='id identifier rubyid_sort_versions'>sort_versions</span><span class='lparen'>(</span><span class='id identifier rubyid_versions'>versions</span><span class='rparen'>)</span>

    <span class='comment'>#Workaround filter out branch and label setting because branch will deleted after publishing the release
</span>    <span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_collect!'>collect!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span>
        <span class='id identifier rubyid_elem'>elem</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
        <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
            <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k2'>k2</span><span class='comma'>,</span><span class='id identifier rubyid_v2'>v2</span><span class='op'>|</span>
                <span class='kw'>if</span> <span class='id identifier rubyid_k2'>k2</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&quot;</span></span>
                    <span class='op'>!</span><span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tag</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
                <span class='kw'>else</span>
                    <span class='kw'>true</span>
                <span class='kw'>end</span>
            <span class='kw'>end</span>
            <span class='id identifier rubyid_elem'>elem</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_elem'>elem</span>
    <span class='kw'>end</span>


    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_version_path'>version_path</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_version_path'>version_path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
        <span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='id identifier rubyid_versions'>versions</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Done</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Left to do:</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  - create a release note file in autoproj/</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#RELEASE_NOTES-constant" title="Rock::CLI::Release::RELEASE_NOTES (constant)">RELEASE_NOTES</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>. A template file, created based on the package&#39;s changelog, can be created with</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>    rock-release admin notes </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_release_name'>release_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> LAST_RELEASE_NAME</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  - commit the build configuration and tag it with the release name</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  - push everything</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  - delete the RC</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="push_labels-instance_method">
  
    #<strong>push_labels</strong>(label)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 845</span>

<span class='kw'>def</span> <span class='id identifier rubyid_push_labels'>push_labels</span><span class='lparen'>(</span><span class='id identifier rubyid_label'>label</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_label'>label</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You must specify a label</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_local'>local</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:local</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='label'>checkout_only:</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='id identifier rubyid_importer'>importer</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No importer for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_repository'>repository</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gitorious</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>push</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>autobuild</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_label'>label</span><span class='rparen'>)</span>
        <span class='kw'>else</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Workaround, you have to tag/commit pinning the branch for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> manually, because it is still on gitorious</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="push_to_stable-instance_method">
  
    #<strong>push_to_stable</strong>(branch)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 717</span>

<span class='kw'>def</span> <span class='id identifier rubyid_push_to_stable'>push_to_stable</span><span class='lparen'>(</span><span class='id identifier rubyid_branch'>branch</span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_branch'>branch</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Please pass the tagname of current release</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stable</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_check_out_missing_packages'>check_out_missing_packages</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stable</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_failed_packages'>failed_packages</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_package_sets'>package_sets</span> <span class='op'>=</span> <span class='id identifier rubyid_manifest'>manifest</span><span class='period'>.</span><span class='id identifier rubyid_each_remote_package_set'>each_remote_package_set</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>

    <span class='comment'>#Make sure working copy is clean becasue we need to switch branches in the repros
</span>    <span class='comment'>#TODO find another way?
</span>    <span class='id identifier rubyid_package_sets'>package_sets</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_create_autobuild_package'>create_autobuild_package</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_has_uncommitted_changes?'>has_uncommitted_changes?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not process, because </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> has uncommited changes</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_has_uncommitted_changes?'>has_uncommitted_changes?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='rparen'>)</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not process, because </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> has uncommited changes</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>return</span> <span class='op'>-</span><span class='int'>1</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_packages_to_handle'>packages_to_handle</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='id identifier rubyid_importer'>importer</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span>
        <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>remote</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>push</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>autobuild</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+refs/tags/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_content'>:refs/heads/stable</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>postpruned: failed to push </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_content'> state to stable for: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_failed_packages'>failed_packages</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pkg'>pkg</span>
        <span class='kw'>end</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pushed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_finally_failed'>finally_failed</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_packages'>failed_packages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git'>run_git</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>checkout</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stable_merge</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+refs/tags/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_finally_failed'>finally_failed</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pkg'>pkg</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git'>run_git</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>merge</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-s</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ours</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+refs/heads/stable</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_finally_failed'>finally_failed</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pkg'>pkg</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git'>run_git</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>push</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>autobuild</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stable_merge:stable_merge</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_finally_failed'>finally_failed</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pkg'>pkg</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_call'>call</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hub pull-request -f -m &#39;Automatic rock-release PR: integrate rc-branch in stable&#39; -b stable -h stable_merge</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_erg'>erg</span> <span class='op'>=</span> <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='id identifier rubyid_call'>call</span><span class='rparen'>)</span>
        <span class='kw'>if</span><span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_erg'>erg</span><span class='rparen'>)</span>
            <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not run hub pull request for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>, result is </span><span class='embexpr_beg'>#{</span><span class='gvar'>$?</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_finally_failed'>finally_failed</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pkg'>pkg</span>
        <span class='kw'>end</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Breaking here for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>, because PR creation is untested</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Finally failed packages, please post-process them manually: </span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_finally_failed'>finally_failed</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_rc-instance_method">
  
    #<strong>update_rc</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rock/cli/release_admin.rb', line 606</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_rc'>update_rc</span>
    <span class='id identifier rubyid_branch'>branch</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:branch</span><span class='rbracket'>]</span>

    <span class='comment'># We checkout and branch all packages, not only the stable
</span>    <span class='comment'># ones, to ease release of new packages. This does not mean
</span>    <span class='comment'># that we&#39;re going to release all of them, of course !
</span>    <span class='id identifier rubyid_packages'>packages</span> <span class='op'>=</span> <span class='id identifier rubyid_all_necessary_packages'>all_necessary_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entry'>entry</span><span class='op'>|</span>
        <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_out_missing_packages'>check_out_missing_packages</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_ops'>ops</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>Ops</span><span class='op'>::</span><span class='const'>Snapshot</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest'>manifest</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Query the package sets RC branch</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_package_sets'>package_sets</span> <span class='op'>=</span> <span class='id identifier rubyid_manifest'>manifest</span><span class='period'>.</span><span class='id identifier rubyid_each_remote_package_set'>each_remote_package_set</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
    <span class='id identifier rubyid_package_sets'>package_sets</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_package_sets'>package_sets</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_repository_id'>repository_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_create_autobuild_package'>create_autobuild_package</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_has_commit?'>has_commit?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refs/remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The package set </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> hasn&#39;t the requested branch </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_content'>, maybe create the rc-first</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_versions'>versions</span> <span class='op'>&lt;&lt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pkg_set:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg_set'>pkg_set</span><span class='period'>.</span><span class='id identifier rubyid_repository_id'>repository_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_branch'>branch</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Query the packages RC branch</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># Deal with the packages that are managed within Rock
</span>    <span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='comma'>,</span> <span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_packages'>packages</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span>
        <span class='op'>!</span><span class='id identifier rubyid_excluded_by_user'>excluded_by_user</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rock_package?'>rock_package?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='const'>Autoproj</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_packages_to_branch_out'>packages_to_branch_out</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_pkg'>pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_has_commit?'>has_commit?</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg'>pkg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>refs/remotes/autobuild/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The package </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>  hasn&#39;t the requested branch </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_branch'>branch</span><span class='embexpr_end'>}</span><span class='tstring_content'>, maybe create the rc-first</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_versions'>versions</span> <span class='op'>&lt;&lt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=&gt;</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_branch'>branch</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_versions'>versions</span> <span class='op'>+=</span> <span class='id identifier rubyid_ops'>ops</span><span class='period'>.</span><span class='id identifier rubyid_snapshot_packages'>snapshot_packages</span><span class='lparen'>(</span><span class='id identifier rubyid_packages_to_snapshot'>packages_to_snapshot</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_pkg'>pkg</span><span class='op'>|</span> <span class='id identifier rubyid_pkg'>pkg</span><span class='period'>.</span><span class='id identifier rubyid_autobuild'>autobuild</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_vcs'>vcs</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>VCSDefinition</span><span class='period'>.</span><span class='id identifier rubyid_from_raw'>from_raw</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#ROCK_RELEASE_INFO-constant" title="Rock::CLI::Release::ROCK_RELEASE_INFO (constant)">ROCK_RELEASE_INFO</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_buildconf'>buildconf</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>Ops</span><span class='op'>::</span><span class='const'>Tools</span><span class='period'>.</span>
        <span class='id identifier rubyid_create_autobuild_package'>create_autobuild_package</span><span class='lparen'>(</span><span class='id identifier rubyid_vcs'>vcs</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main configuration</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_config_dir'>config_dir</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_version_commit'>version_commit</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>Ops</span><span class='op'>::</span><span class='const'>Snapshot</span><span class='period'>.</span><span class='id identifier rubyid_create_commit'>create_commit</span><span class='lparen'>(</span><span class='id identifier rubyid_buildconf'>buildconf</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#RELEASE_VERSIONS-constant" title="Rock::CLI::Release::RELEASE_VERSIONS (constant)">RELEASE_VERSIONS</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version file for tracking the release candidate</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
        <span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='id identifier rubyid_versions'>versions</span><span class='comma'>,</span> <span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_notes_commit'>notes_commit</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>Ops</span><span class='op'>::</span><span class='const'>Snapshot</span><span class='period'>.</span><span class='id identifier rubyid_create_commit'>create_commit</span><span class='lparen'>(</span><span class='id identifier rubyid_buildconf'>buildconf</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Release.html" title="Rock::CLI::Release (class)">Release</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Release.html#RELEASE_NOTES-constant" title="Rock::CLI::Release::RELEASE_NOTES (constant)">RELEASE_NOTES</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>release notes file to please rock-release</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_version_commit'>version_commit</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
        <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is an empty file meant to allow rock-release to see rock-rc as a release</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_bootstrap_commit'>bootstrap_commit</span> <span class='op'>=</span> <span class='const'>Autoproj</span><span class='op'>::</span><span class='const'>Ops</span><span class='op'>::</span><span class='const'>Snapshot</span><span class='period'>.</span><span class='id identifier rubyid_create_commit'>create_commit</span><span class='lparen'>(</span><span class='id identifier rubyid_buildconf'>buildconf</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bootstrap.sh</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bootstrap.sh for this release</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_notes_commit'>notes_commit</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
        <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_buildconf'>buildconf</span><span class='period'>.</span><span class='id identifier rubyid_srcdir'>srcdir</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bootstrap.sh</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BOOTSTRAP_ARGS=</span><span class='tstring_end'>&quot;</span></span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BOOTSTRAP_ARGS=branch=rock-rc</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>else</span>
                <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_line'>line</span>
            <span class='kw'>end</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_buildconf'>buildconf</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_buildconf'>buildconf</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>branch</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-f</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rock-rc</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_bootstrap_commit'>bootstrap_commit</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_buildconf'>buildconf</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_run_git_bare'>run_git_bare</span><span class='lparen'>(</span><span class='id identifier rubyid_buildconf'>buildconf</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>push</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-f</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_buildconf'>buildconf</span><span class='period'>.</span><span class='id identifier rubyid_importer'>importer</span><span class='period'>.</span><span class='id identifier rubyid_push_to'>push_to</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Apr  9 14:55:04 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.5.1).
</div>

    </div>
  </body>
</html>